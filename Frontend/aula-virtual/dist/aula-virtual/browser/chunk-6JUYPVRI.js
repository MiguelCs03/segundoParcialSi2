import{a as k,b as S,c as V,f as F,h as N,l as O,m as T,p as W}from"./chunk-L7N6OICC.js";import{a as C}from"./chunk-I3GQ3KJJ.js";import{Da as E,G as l,I as p,Ia as w,J as v,Ma as M,N as _,Pa as I,Q as u,Sa as A,U as a,V as r,Z as y,_ as g,fa as n,ga as x,ka as f,la as b,ma as h,w as s,x as m}from"./chunk-4LX2SAQG.js";function D(d,o){if(d&1){let t=y();a(0,"tr")(1,"td",6),n(2),r(),a(3,"td",7)(4,"input",10),h("ngModelChange",function(e){let c=s(t).$implicit;return b(c.entregado,e)||(c.entregado=e),m(e)}),r()(),a(5,"td",7)(6,"input",11),h("ngModelChange",function(e){let c=s(t).$implicit;return b(c.calificacion,e)||(c.calificacion=e),m(e)}),r()()()}if(d&2){let t=o.$implicit;l(2),x(t.nombreEstudiante),l(2),f("ngModel",t.entregado),l(2),f("ngModel",t.calificacion),u("disabled",!t.entregado)}}var B=class d{constructor(o,t){this.route=o;this.http=t}detalleId;actividadId;entregas=[];ngOnInit(){this.detalleId=+this.route.snapshot.paramMap.get("id"),this.actividadId=+this.route.snapshot.paramMap.get("actividadId"),this.cargarEntregas()}cargarEntregas(){let t={Authorization:`Bearer ${localStorage.getItem("access_token")}`};this.http.get(C.apiUrl+`api/profesor/materia/${this.detalleId}/actividad/${this.actividadId}/entregas/`,{headers:t}).subscribe({next:i=>{this.entregas=i.map(e=>({usuario:e.usuario,nombreEstudiante:e.nombreEstudiante||"Estudiante",entregado:e.entregado,calificacion:e.calificacion}))},error:i=>{console.error("Error al cargar entregas:",i)}})}guardarCalificaciones(){let t={Authorization:`Bearer ${localStorage.getItem("access_token")}`},i=this.entregas.map(e=>({usuario_id:e.usuario,entregado:e.entregado,calificacion:e.entregado?e.calificacion:null}));this.http.post(C.apiUrl+`api/actividades/${this.actividadId}/registrar-entregas/`,i,{headers:t}).subscribe({next:()=>alert("Calificaciones guardadas correctamente"),error:e=>console.error("Error al guardar calificaciones:",e)})}volver(){window.history.back()}static \u0275fac=function(t){return new(t||d)(p(A),p(M))};static \u0275cmp=v({type:d,selectors:[["app-calificar-actividad"]],decls:19,vars:1,consts:[[1,"p-6","max-w-4xl","mx-auto","bg-white","rounded","shadow"],[1,"flex","justify-between","items-center","mb-4"],[1,"text-2xl","font-bold"],[1,"px-4","py-2","border","rounded","hover:bg-gray-100",3,"click"],[1,"w-full","border-collapse","border","border-gray-300","mb-4"],[1,"bg-gray-100"],[1,"border","border-gray-300","p-2"],[1,"border","border-gray-300","p-2","text-center"],[4,"ngFor","ngForOf"],[1,"bg-blue-600","text-white","px-4","py-2","rounded","hover:bg-blue-700",3,"click"],["type","checkbox",3,"ngModelChange","ngModel"],["type","number","min","0","max","100",1,"w-20","p-1","border","rounded",3,"ngModelChange","ngModel","disabled"]],template:function(t,i){t&1&&(a(0,"div",0)(1,"div",1)(2,"h2",2),n(3,"Calificar Entregas"),r(),a(4,"button",3),g("click",function(){return i.volver()}),n(5," \u2190 Volver "),r()(),a(6,"table",4)(7,"thead")(8,"tr",5)(9,"th",6),n(10,"Estudiante"),r(),a(11,"th",7),n(12,"Entregado"),r(),a(13,"th",7),n(14,"Calificaci\xF3n"),r()()(),a(15,"tbody"),_(16,D,7,4,"tr",8),r()(),a(17,"button",9),g("click",function(){return i.guardarCalificaciones()}),n(18," Guardar Calificaciones "),r()()),t&2&&(l(16),u("ngForOf",i.entregas))},dependencies:[w,E,I,W,S,N,k,V,T,O,F],encapsulation:2})};export{B as CalificarActividadComponent};
