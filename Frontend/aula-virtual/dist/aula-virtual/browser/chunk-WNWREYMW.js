import{a as D}from"./chunk-7DRB3ET5.js";import{a as A}from"./chunk-UOSVOCXT.js";import"./chunk-KOVQJSC4.js";import"./chunk-I3GQ3KJJ.js";import{$ as m,Ca as y,Da as S,Ea as I,G as o,I as u,J as b,N as c,Q as d,U as i,Ua as E,V as n,W as x,Z as f,_ as h,fa as r,ga as s,ha as p,pa as _,w as g,x as v}from"./chunk-4LX2SAQG.js";var M=(a,t)=>({"text-green-600":a,"text-yellow-500":t});function F(a,t){a&1&&(i(0,"div",14),x(1,"div",15),i(2,"span",16),r(3,"Cargando materias..."),n()())}function T(a,t){if(a&1&&(i(0,"div",17)(1,"p"),r(2),n()()),a&2){let e=m();o(2),s(e.error)}}function P(a,t){if(a&1){let e=f();i(0,"div",5)(1,"div",21),r(2),n(),i(3,"p",22),r(4),n(),i(5,"p",23),r(6),n(),i(7,"p",24),r(8,"Promedio: "),i(9,"span",25),r(10),n()(),i(11,"button",26),h("click",function(){let w=g(e).$implicit,N=m(2);return v(N.verDetalleMateria(w))}),r(12," Ver Detalles "),n()()}if(a&2){let e=t.$implicit;o(2),p("ID: ",e.id||"SIN ID",""),o(2),s(e.nombre),o(2),p("Profesor: ",e.profesor,""),o(4),s(e.promedio)}}function k(a,t){if(a&1&&(i(0,"div")(1,"h3",18),r(2,"Materias actuales"),n(),i(3,"div",19),c(4,P,13,4,"div",20),n()()),a&2){let e=m();o(4),d("ngForOf",e.materias)("ngForTrackBy",e.trackByMateriaId)}}function O(a,t){a&1&&(i(0,"div",30),r(1," No hay actividades recientes "),n())}function R(a,t){if(a&1&&(i(0,"tr",35)(1,"td",33),r(2),n(),i(3,"td"),r(4),n(),i(5,"td")(6,"span",36),r(7),n()()()),a&2){let e=t.$implicit;o(2),s(e.materia),o(2),s(e.titulo),o(2),d("ngClass",_(4,M,e.estado==="Entregado",e.estado==="Pendiente")),o(),s(e.estado)}}function j(a,t){if(a&1&&(i(0,"table",31)(1,"thead")(2,"tr",32)(3,"th",33),r(4,"Materia"),n(),i(5,"th"),r(6,"T\xEDtulo"),n(),i(7,"th"),r(8,"Estado"),n()()(),i(9,"tbody"),c(10,R,8,7,"tr",34),n()()),a&2){let e=m(2);o(10),d("ngForOf",e.actividades)}}function B(a,t){if(a&1&&(i(0,"div")(1,"h3",18),r(2,"Actividades recientes"),n(),i(3,"div",27),c(4,O,2,0,"div",28)(5,j,11,1,"table",29),n()()),a&2){let e=m();o(4),d("ngIf",e.actividades.length===0),o(),d("ngIf",e.actividades.length>0)}}var C=class a{constructor(t,e){this.alumnoService=t;this.router=e}resumen={promedio:"N/A",asistencia:0,participacion:0,prediccion:"N/A"};materias=[];actividades=[];cargando=!0;error="";ngOnInit(){this.cargarDatos()}cargarDatos(){this.cargando=!0,this.error="",this.alumnoService.getResumenDashboard().subscribe({next:t=>{console.log("Resumen recibido:",t),this.procesarResumen(t),this.cargando=!1},error:t=>{console.error("Error al cargar resumen:",t),this.cargarSoloMaterias()}})}procesarResumen(t){this.resumen={promedio:t.promedio||"N/A",asistencia:t.porcentaje_asistencia||0,participacion:t.porcentaje_participacion||0,prediccion:t.prediccion||"N/A"},t.materias&&Array.isArray(t.materias)&&(this.materias=t.materias.map(e=>({id:e.id,nombre:e.nombre,profesor:e.profesor,promedio:e.promedio||"N/A"}))),this.actividades=t.actividades_recientes||[]}cargarSoloMaterias(){this.alumnoService.getMateriasPorAlumno().subscribe({next:t=>{console.log("Materias recibidas desde backend:",t),this.materias=t.map(e=>(console.log("Procesando materia:",e),e.id||console.error("\u274C Materia sin ID:",e),{id:e.id,nombre:e.nombre,profesor:e.profesor,promedio:e.promedio||"N/A",curso:e.curso,paralelo:e.paralelo})),console.log("Materias procesadas para frontend:",this.materias),this.cargando=!1},error:t=>{console.error("Error al cargar materias:",t),this.error="Error al cargar las materias",this.cargando=!1}})}verDetalleMateria(t){if(console.log("=== DEBUG NAVEGACI\xD3N ==="),console.log("Materia completa:",t),console.log("ID de materia:",t.id),!t||!t.id){console.error("\u274C Error: La materia no tiene ID v\xE1lido"),alert("Error: No se puede acceder al detalle de esta materia. ID faltante.");return}console.log("\u2705 Navegando a:",`/mi-rendimiento/materia/${t.id}`),this.router.navigate(["/mi-rendimiento/materia",t.id])}trackByMateriaId(t,e){return e.id||t}static \u0275fac=function(e){return new(e||a)(u(D),u(E))};static \u0275cmp=b({type:a,selectors:[["app-alumno-dashboard"]],decls:30,vars:8,consts:[[1,"flex","min-h-screen"],[1,"w-64"],[1,"flex-1","p-6","bg-gradient-to-b","from-blue-100","to-blue-300","overflow-auto"],[1,"text-2xl","font-bold","mb-6"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-4","mb-8"],[1,"bg-white","p-4","rounded","shadow"],[1,"text-gray-500"],[1,"text-2xl","font-bold","text-blue-600"],[1,"text-2xl","font-bold","text-green-600"],[1,"text-2xl","font-bold","text-yellow-500"],[1,"text-2xl","font-bold","text-purple-600"],["class","flex justify-center items-center my-8",4,"ngIf"],["class","bg-red-100 border-l-4 border-red-500 text-red-700 p-4 mb-6 rounded",4,"ngIf"],[4,"ngIf"],[1,"flex","justify-center","items-center","my-8"],[1,"animate-spin","rounded-full","h-8","w-8","border-t-2","border-blue-500"],[1,"ml-2"],[1,"bg-red-100","border-l-4","border-red-500","text-red-700","p-4","mb-6","rounded"],[1,"text-xl","font-semibold","mb-2"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4","mb-8"],["class","bg-white p-4 rounded shadow",4,"ngFor","ngForOf","ngForTrackBy"],[1,"text-xs","text-gray-400","mb-1"],[1,"text-lg","font-bold"],[1,"text-sm","text-gray-500"],[1,"text-sm"],[1,"text-blue-600","font-semibold"],[1,"mt-3","bg-blue-600","hover:bg-blue-700","text-white","px-4","py-1","rounded",3,"click"],[1,"bg-white","rounded","shadow","p-4"],["class","text-center py-4 text-gray-500",4,"ngIf"],["class","w-full table-auto",4,"ngIf"],[1,"text-center","py-4","text-gray-500"],[1,"w-full","table-auto"],[1,"text-left","border-b"],[1,"py-2"],["class","border-b hover:bg-gray-50",4,"ngFor","ngForOf"],[1,"border-b","hover:bg-gray-50"],[3,"ngClass"]],template:function(e,l){e&1&&(i(0,"div",0),x(1,"app-sidebar",1),i(2,"main",2)(3,"h2",3),r(4,"Bienvenido, Alumno"),n(),i(5,"div",4)(6,"div",5)(7,"p",6),r(8,"Promedio actual"),n(),i(9,"p",7),r(10),n()(),i(11,"div",5)(12,"p",6),r(13,"Asistencia"),n(),i(14,"p",8),r(15),n()(),i(16,"div",5)(17,"p",6),r(18,"Participaci\xF3n"),n(),i(19,"p",9),r(20),n()(),i(21,"div",5)(22,"p",6),r(23,"Predicci\xF3n"),n(),i(24,"p",10),r(25),n()()(),c(26,F,4,0,"div",11)(27,T,3,1,"div",12)(28,k,5,2,"div",13)(29,B,6,2,"div",13),n()()),e&2&&(o(10),s(l.resumen.promedio),o(5),p("",l.resumen.asistencia,"%"),o(5),p("",l.resumen.participacion,"%"),o(5),s(l.resumen.prediccion),o(),d("ngIf",l.cargando),o(),d("ngIf",l.error),o(),d("ngIf",!l.cargando),o(),d("ngIf",!l.cargando))},dependencies:[S,y,I,A],encapsulation:2})};export{C as AlumnoDashboardComponent};
